{
    "name": "comps.iscoming",
    "command": "let competitor = input\nlet comp_name = IRC.command.params[0];\n// Get closest matching competition to query\nlet obj = fetchSync(\"https://api.worldcubeassociation.org/competitions?q=\"+comp_name+\"&start=\"+new Date().toISOString().split(\"T\")[0],{\"type\": \"json\"})\n\nif (obj){\n    let comp = obj[0]\n    if(!comp){\n\t    print(\"Comp in the past\");\n\t    return;\n    }\n    let comp_id = comp[\"url\"].split(\"/\")[4]\n    let url = \"https://worldcubeassociation.org/api/v0/competitions/\"+comp_id+\"/wcif/public\"\n    let wcif = fetchSync(url,{type:\"json\"})\n    let competitors = wcif[\"persons\"]\n    let search = competitors.filter( x => x[\"name\"].toLowerCase().indexOf(competitor.toLowerCase()) != -1)\n     \n    if(search.length == 1){\n        print(search[0][\"name\"] + \" is coming to \" + comp[\"name\"]) \n    }\n    else if (search.length == 0){\n        print(\"There is no \" + competitor + \" coming to \" + comp[\"name\"])\n    }\telse{\n\tprint(\"Competitors matching the query\")\n        search.map((x,i) => print((i + 1) + \". \" +  x[\"name\"]))\n    }\n    \n}else{\n    print(\"No comp found\")\n}",
    "locked": false,
    "starred": false
}