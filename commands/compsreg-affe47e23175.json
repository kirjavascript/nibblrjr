{
    "name": "comps.reg",
    "command": "// Get closest matching competition to query\nlet obj = fetchSync(\"https://api.worldcubeassociation.org/competitions?q=\"+input+\"&start=\"+new Date().toISOString().split(\"T\")[0],{\"type\": \"json\"})\n\nif (obj){\n    let comp = obj[0]\n    if(!comp){\n        print(\"Competition not announced\");\n        return\n    }\n    print(comp[\"name\"])\n    let comp_id = comp[\"url\"].split(\"/\")[4]\n    let dom = fetchSync(\"https://www.worldcubeassociation.org/competitions/\"+comp_id,{type:\"dom\"})\n    \n    let dates = dom.document.getElementsByClassName(\"wca-local-time\")\n    let days = (new Date(dates[0].attributes[\"data-utc-time\"].nodeValue) - new Date()) / (1000*60*60*24)\n    \n    if(days < 0){\n        print(\"Registration is open\")\n    }\n    else if (days < 1){\n        print(`Registration will open in ${Math.floor(days * 24)} hours`)\n    }\n    else {\n        print(`Registration will open in ${Math.floor(days)} days`)\n    }\n    \n    \n}else{\n    print(\"No comp found\")\n}",
    "locked": false,
    "starred": false
}