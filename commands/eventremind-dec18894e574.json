{
    "event": false,
    "locked": false,
    "starred": false,
    "name": "event.remind",
    "command": "IRC.listen('tick', ({ target, server }) => {\n    IRC.setNamespace('remind');\n    SQL.async.many`\n        SELECT \"from\", \"time\", \"message\" from remind\n        WHERE \"when\" < ${(new Date).toISOString()}\n        AND server = ${server}\n        AND channel = ${target} \n    `.then(messages => {\n        // \n        // log(messages);\n    }).catch(() => {});\n}, { filter: () => IRC.queryConfig('enableRemind', true) })\n\nIRC.setNamespace('remind');\nif (!SQL.one`SELECT 1 FROM sqlite_master WHERE name='remind'`) {\n    SQL.exec`\n        DROP TABLE IF EXISTS remind;\n\n        CREATE TABLE remind (\n            key INTEGER PRIMARY KEY AUTOINCREMENT UNIQUE,\n            \"from\" VARCHAR (100),\n            \"when\" DATETIME,\n            server TEXT,\n            channel TEXT,\n            message TEXT,\n            time DATETIME DEFAULT ((DATETIME(CURRENT_TIMESTAMP, 'LOCALTIME')))\n        );\n\n        CREATE INDEX idx_to\n        ON remind ('to', 'when');\n    `;\n}\n"
}