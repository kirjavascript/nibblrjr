{
    "locked": false,
    "starred": false,
    "name": "module.leaderboard",
    "command": "function render({\n    currency = '',\n    scores = [/*{ name, score, extra }*/],\n    combine = true,\n    limit = 5,\n    reverse = false,\n    title = 'Leaderboard',\n    groupPosition = false,\n    fmtNum = (score) => Intl.NumberFormat().format(+score),\n    fmtRank = (item, index) => index + 1,\n}) {\n    const output = [];\n    if (title) {\n        output.push(`{u}${title}{/}`);\n    }\n    // assert text in extra\n    scores.forEach(obj => { obj.extra = obj.extra || ''; })\n\n    const sortScores = (combine ? combineScores(scores) : scores)\n        .sort((a, b) => a.score - b.score);\n\n    const filterScores = (!reverse ? sortScores.reverse() : sortScores)\n        .slice(0, limit || undefined);\n\n    const longestName = Math.max(15, getLongestName(filterScores));\n    const longestValue = filterScores.reduce((acc, cur) => Math.max(acc, fmtNum(cur.score).length), 0) + currency.length;\n\n    const colours = ['{y}','{gr}','{o}'];\n\n    // name can be string / array\n\n    let i = 0;\n    filterScores.forEach((item, index) => {\n        const { name, score, extra } = item;\n        const nameRaw = Array.isArray(name) ? name.join(', ') : name;\n        const fmtName = nameRaw.replace(/\\w+/g, IRC.breakHighlight);\n        const fmtScore = fmtNum(score);\n        const number = fmtRank(item, index);\n        const colour = colours[index] || '';\n        const padding = '.'.repeat(Math.max(\n            2 + longestName + longestValue - nameRaw.length - fmtScore.length - (String(number).length - 1),\n            0,\n        ));\n\n        output.push(`${number}. ${colour}${fmtName}{/}{bo}${padding}{/}{y}${currency}${fmtScore}{/}${extra ? ` ${extra}`:''}`);\n\n        // inc\n        if (!groupPosition || !Array.isArray(name)) {\n            i += 1;\n        } else {\n            i += name.length;\n        }\n    });\n\n    return output.join('\\n');\n}\n\nfunction combineScores(scores) {\n    return scores.reduce((acc, cur) => {\n        const exists = acc.findIndex((d) => d.score === cur.score);\n        if (exists !== -1) {\n            acc[exists].name.push(cur.name);\n            acc[exists].extra += ' ' + cur.extra;\n        } else {\n            cur.name = [cur.name];\n            acc.push(cur);\n        }\n        return acc;\n    }, []);\n}\n\nfunction getLongestName(scores) {\n    return scores.reduce((acc, cur) => (\n        Math.max(acc, Array.isArray(cur.name) ? cur.name.join(', ').length : cur.name.length)\n    ), 0);\n}\n\nmodule.exports = render;"
}