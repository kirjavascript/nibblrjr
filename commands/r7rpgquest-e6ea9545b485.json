{
    "locked": false,
    "starred": false,
    "name": "r7rpg.quest",
    "command": "const { from } = IRC.message\nconst { getPlayer, savePlayer } = IRC.require('r7rpg.game')\nplayer = getPlayer()\n\nconst resetQuest = () => {\n  IRC.require('r7rpg.player').resetQuest()\n}\n\nconst findQuest = () => {\n  if (IRC.require('r7rpg.quest_df1').checkRequirements(player)) {\n    IRC.require('r7rpg.quest_df1').displayIntro()\n  } else if (IRC.require('r7rpg.quest_qcs').checkRequirements(player)) {\n    IRC.require('r7rpg.quest_qcs').displayIntro()\n  } else {\n    throw new Error(`{dc}${from}{/}: There are no new quests available`)\n  }\n}\n\nconst checkQuests = () => {\n  if (IRC.require('r7rpg.quest_df1').checkRequirements(player)) {\n    print(`{dc}${from}{/}: New quest {dr}Dark Forest{/} is available`)\n  }\n  if (IRC.require('r7rpg.quest_qcs').checkRequirements(player)) {\n    print(`{dc}${from}{/}: New quest {b}Queen Christina's Sanctuary{/} is available`)\n  }\n}\n\nconst inQuest = () => {\n  if (player.quest && player.quest.name != null) {\n    return true\n  } else {\n    return false\n  }\n}\n\nconst completeQuest = () => {\n  IRC.require('r7rpg.game').incrementInfo('quests_completed')\n  IRC.require('r7rpg.player').completeQuest()\n  IRC.require('r7rpg.player').resetQuest()\n  IRC.require('r7rpg.player').reset()\n}\n\nif (! player.quest) {\n  resetQuest()\n}\n\nif (!module.required && inQuest()) {\n  if (input) {\n    if (! IRC.require(player.quest.command).receiveCommand(input)) {\n      throw new Error(`{dc}${from}{/}: You are already in a quest..`)\n    }\n  } else {\n    throw new Error(`{dc}${from}{/}: You are already in a quest..`)\n  }\n}\n\nif (input && !module.required) {\n  if (player.status.type != 'idle') {\n    throw new Error(`{dc}${from}{/} You cannot quest (Status: ${player.status.type})`)\n  }\n  let silent = false\n  if (IRC.command.params[0] === 'silent') {\n    silent = true\n  }\n  switch (input) {\n    case \"Dark Forest\":\n      if (IRC.require('r7rpg.quest_df1').checkRequirements(player)) {\n        IRC.require('r7rpg.game').incrementInfo('quests_started')\n        IRC.require('r7rpg.quest_df1').loadQuest(silent)\n      } else {\n        throw new Error(`{dc}${from}{/} You do not meet the requirements for this quest`)\n      }\n      break\n    case \"Queen Christina's Sanctuary\":\n      if (IRC.require('r7rpg.quest_qcs').checkRequirements(player)) {\n        IRC.require('r7rpg.game').incrementInfo('quests_started')\n        IRC.require('r7rpg.quest_qcs').loadQuest(silent)\n      } else {\n        throw new Error(`{dc}${from}{/} You do not meet the requirements for this quest`)\n      }\n      break\n    default:\n      findQuest()\n      break\n  }\n} else {\n  if (!module.required) {\n    findQuest()\n  }\n}\n\nmodule.exports = {\n  resetQuest,\n  inQuest,\n  completeQuest,\n  checkQuests\n}"
}