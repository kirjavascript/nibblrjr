{
    "locked": false,
    "starred": false,
    "name": "r7rpg.quest_qcs",
    "command": "const { from } = IRC.message\nconst { getPlayer, savePlayer } = IRC.require('r7rpg.game')\nplayer = getPlayer()\n\nconst requirements = {\n  level: 9,\n}\n\nconst intro = `{dc}${from}{/}: While journeying through a quiet wood, you come across a clearing with a gently babbling brook coursing through it.  Do you enter the clearing?`\n\nconst stage1Intro1 = `{dc}${from}{/}: You stand by the bank and dip your toes into the cool, refreshing waters.  As your weariness slowly slips downstream, several ducks across the water seem to take notice of you.`\nconst stage1Intro2 = `{dc}${from}{/}: The ducks start wading towards you, menacingly.  Amidst a chorus of quacks, they attack!`\n\nconst stage1Outro = `{dc}${from}{/}: You gaze around in shock as you notice that the floor of the tranquil grove is now littered with feathers and beaks.`\n\nconst stage2Intro = `{dc}${from}{/}: While contemplating the horror you have just unleashed on this peaceful place, a group of geese swoop down from the treeline.`\nconst stage2Outro = `{dc}${from}{/}: While catching your breath and wiping the geese viscera from your face, something catches the corner of your eye.`\n\nconst stage3Intro1 = `{dc}${from}{/}: Looking left and right, you realize that two loons have flanked you on either side of the brook.`\nconst stage3Intro2 = `{dc}${from}{/}: Suddenly, the loons rush in to attack.  You brace yourself for combat.`\nconst stage3Outro = `{dc}${from}{/}: All is calm again.  You take a moment to collect your wits and turn to leave this massacre of your own making.`\n\nconst stage4Intro1 = `{dc}${from}{/}: Behind you, you hear a gentle bubbling noise coming from the waters.  Turning around again, you notice the previously calm surface in the middle of the brook roiling and the surface tension breaking.`\nconst stage4Intro2 = `{dc}${from}{/}: From beneath the waters, the guardian of the sanctuary slowly rises up.  Before you floats an enormous swan, its eyes black with rage and hatred.`\nconst stage4Intro3 = `{dc}${from}{/}: Without warning, it hisses and flaps its way towards you, faster than you would have thought it could move.`\nconst stage4Outro = `{dc}${from}{/}: The guardian having been felled, this rookery is most certainly worse off than before your arrival, but you have survived.  Shrugging your shoulders, you head back into the quiet wood, continuing your journey.`\n\nconst displayIntro = () => {\n  print(intro)\n  print(`{dc}${from}{/}: Use {y}~r7rpg.quest Queen Christina's Sanctuary{/} to continue..`)\n}\n\nconst checkRequirements = (_player = player, verbose = false) => {\n  if (verbose) {\n    if (_player.stats.level < requirements.level) {\n      throw new Error(`{dc}${from}{/}: You must be level ${requirements.level} to attempt this quest`)\n    }\n    if (_player.completed_quests && _player.completed_quests.includes('Queen Christina\\'s Sanctuary')) {\n      throw new Error(`{dc}${from}{/}: You have already completed this quest`)\n    }\n    return true\n  } else {\n    if (_player.stats.level >= requirements.level) {\n      if (! _player.completed_quests || ! _player.completed_quests.includes('Queen Christina\\'s Sanctuary')) {\n        return true\n      }\n    }\n    return false\n  }\n}\n\nconst loadQuest = (silent) => {\n  player.quest.name = 'Queen Christina\\'s Sanctuary'\n  player.quest.command = 'r7rpg.quest_qcs'\n  player.quest.stage = 1\n  player.quest.attackCount = 0\n  player.quest.silent = silent\n  savePlayer(player)\n  stage1Start()\n}\n\nconst stage1Start = () => {\n  if (! player.quest.silent) {\n    print(stage1Intro1)\n    sleep(2000)\n    print(stage1Intro2)\n    sleep(1000)\n  }\n  player.quest.silenceKills = true\n  savePlayer(player)\n  IRC.require('r7rpg.enemies').newEnemy(\"4 Daring Ducks\", player.stats.level, 0.5)\n}\n\nconst stage1End = () => {\n  if (! player.quest.silent) {\n    print(stage1Outro)\n    sleep(2000)\n  }\n  stage2Start()\n}\n\nconst stage2Start = () => {\n  player.quest.stage++\n  if (! player.quest.silent) {\n    print(stage2Intro)\n    sleep(2000)\n  }\n  player.quest.silenceKills = true\n  savePlayer(player)\n  IRC.require('r7rpg.enemies').newEnemy(\"3 Giant Geese\", player.stats.level + 1, 0.7)\n}\n\nconst stage2End = () => {\n  if (! player.quest.silent) {\n    print(stage2Outro)\n    sleep(2000)\n  }\n  stage3Start()\n}\n\nconst stage3Start = () => {\n  player.quest.stage++\n  savePlayer(player)\n  if (! player.quest.silent) {\n    print(stage3Intro1)\n    sleep(2000)\n    print(stage3Intro2)\n    sleep(1000)\n  }\n  player.quest.silenceKills = true\n  savePlayer(player)\n  IRC.require('r7rpg.enemies').newEnemy(\"2 Lanky Loons\", player.stats.level + 2, 0.9)\n}\n\nconst stage3End = () => {\n  if (! player.quest.silent) {\n    print(stage3Outro)\n    sleep(2000)\n  }\n  stage4Start()\n}\n\nconst stage4Start = () => {\n  player.quest.stage++\n  savePlayer(player)\n  if (! player.quest.silent) {\n    print(stage4Intro1)\n    sleep(2000)\n    print(stage4Intro2)\n    sleep(2000)\n    print(stage4Intro3)\n    sleep(1000)\n  }\n  player.quest.silenceKills = true\n  savePlayer(player)\n  IRC.require('r7rpg.enemies').newEnemy(\"Psychotic Swan\", player.stats.level + 4, 1.4)\n}\n\nconst stage4End = () => {\n  print(stage4Outro)\n  print(`{dc}${from}{/} has completed {y,b} Queen Christina's Sanctuary by Monqui {/}`)\n  IRC.require('r7rpg.player').giveItem('Goose Beak', '{o}Quest{/}')\n  IRC.require('r7rpg.player').giveItem('Queen Christina\\'s Sanctuary Medal', '{o}Quest{/}')\n  IRC.require('r7rpg.player').giveItem()\n  IRC.require('r7rpg.player').giveItem()\n  IRC.require('r7rpg.player').giveItem()\n  IRC.require('r7rpg.player').addXp(1000, true)\n  IRC.require('r7rpg.game').incrementInfo('quest_queen_christinas_sanctuary_completed')\n  IRC.require('r7rpg.quest').completeQuest()\n}\n\nconst onPlayerAttack = () => {\n  player.quest.attackCount++\n  savePlayer(player)\n}\n\nconst attackChance = (percent_voiceline_chance, voiceline) => {\n  if (Math.floor(Math.random() * 100) > percent_voiceline_chance) {\n    IRC.require('r7rpg.player').enemyAttack()\n  } else {\n    print(`{o}${voiceline}`)\n  }\n}\n\nconst onEnemyAttack = () => {\n  switch (player.enemy.name) {\n    case \"4 Daring Ducks\":\n\t  if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      break\n    case \"3 Daring Ducks\":\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      break\n    case \"2 Daring Ducks\":\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      break\n    case \"Daring Duck\":\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      break\n    case \"3 Giant Geese\":\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(20, '*Honk*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(20, '*Honk*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(20, '*Woof*')\n      }\n      break\n    case \"2 Giant Geese\":\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(20, '*Honk*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(20, '*Woof*')\n      }\n      break\n    case \"Giant Goose\":\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(20, '*Woof*')\n      }\n      break\n    case \"2 Lanky Loons\":\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(20, '*Makes whatever sound a Loon makes*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(20, '*Makes whatever sound a Loon makes*')\n      }\n      break\n    case \"Lanky Loon\":\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(20, '*Makes whatever sound a Loon makes*')\n      }\n      break\n    case \"Psychotic Swan\":\n      attackChance(25, '*Hiss*')\n      break\n    default:\n      break\n  }\n}\n\nconst onEnemyDead = () => {\n  switch (player.enemy.name) {\n    case \"4 Daring Ducks\":\n      print(`{dc}${from}{/} killed one of the enemy {g}${player.enemy.name}{/} ({p}+${player.enemy.xp}xp {y}+$${player.enemy.money}{/})`)\n      IRC.require('r7rpg.enemies').newEnemy(\"3 Daring Ducks\", player.stats.level, 0.5, false)\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      break\n    case \"3 Daring Ducks\":\n      print(`{dc}${from}{/} killed one of the enemy {g}${player.enemy.name}{/} ({p}+${player.enemy.xp}xp {y}+$${player.enemy.money}{/})`)\n      IRC.require('r7rpg.enemies').newEnemy(\"2 Daring Ducks\", player.stats.level, 0.5, false)\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      break\n    case \"2 Daring Ducks\":\n      print(`{dc}${from}{/} killed one of the enemy {g}${player.enemy.name}{/} ({p}+${player.enemy.xp}xp {y}+$${player.enemy.money}{/})`)\n      player.quest.silenceKills = false\n      savePlayer(player)\n      IRC.require('r7rpg.enemies').newEnemy(\"Daring Duck\", player.stats.level, 0.5, false)\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Quack*')\n      }\n      break\n    case \"Daring Duck\":\n      IRC.require('r7rpg.player').reset()\n      stage1End()\n      break\n    case \"3 Giant Geese\":\n      print(`{dc}${from}{/} killed one of the enemy {g}${player.enemy.name}{/} ({p}+${player.enemy.xp}xp {y}+$${player.enemy.money}{/})`)\n      IRC.require('r7rpg.enemies').newEnemy(\"2 Giant Geese\", player.stats.level, 0.7, false)\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Honk*')\n      }\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Honk*')\n      }\n      break\n    case \"2 Giant Geese\":\n      print(`{dc}${from}{/} killed one of the enemy {g}${player.enemy.name}{/} ({p}+${player.enemy.xp}xp {y}+$${player.enemy.money}{/})`)\n      player.quest.silenceKills = false\n      savePlayer(player)\n      IRC.require('r7rpg.enemies').newEnemy(\"Giant Goose\", player.stats.level, 0.7, false)\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Honk*')\n      }\n      break\n    case \"Giant Goose\":\n      IRC.require('r7rpg.player').reset()\n      stage2End()\n      break\n    case \"2 Lanky Loons\":\n      print(`{dc}${from}{/} killed one of the enemy {g}${player.enemy.name}{/} ({p}+${player.enemy.xp}xp {y}+$${player.enemy.money}{/})`)\n      player.quest.silenceKills = false\n      savePlayer(player)\n      IRC.require('r7rpg.enemies').newEnemy(\"Lanky Loon\", player.stats.level, 0.9, false)\n      if (IRC.require('r7rpg.player').isAlive()) {\n        attackChance(30, '*Makes whatever sound a Loon makes*')\n      }\n      break\n    case \"Lanky Loon\":\n      IRC.require('r7rpg.player').reset()\n      stage3End()\n      break\n    case \"Psychotic Swan\":\n      IRC.require('r7rpg.player').reset()\n      stage4End()\n    default:\n      break\n  }\n}\n\nconst onPlayerDead = () => {\n  print(`{dc}${from}{/}: You have failed your quest`)\n  IRC.require('r7rpg.quest').resetQuest()\n}\n\nconst onUseItem = (item) => {\n  return true\n}\n\nconst receiveCommand = (command) => {\n  return false\n}\n\nmodule.exports = {\n  displayIntro,\n  checkRequirements,\n  loadQuest,\n  onPlayerAttack,\n  onEnemyAttack,\n  onEnemyDead,\n  onPlayerDead,\n  onUseItem,\n  receiveCommand\n}"
}