{
    "name": "sloots",
    "command": "// disable in PM\nif (IRC.message.isPM) {\n    throw new Error('No sloots in the VIP rooms');\n}\n\n// check delay\nconst lastSpin = store.get('lastspin$' + IRC.message.from);\nconst now = new Date();\nconst dateFns = require('date-fns@1.30.1');const { addMilliseconds, isBefore } = dateFns;\nif (lastSpin && isBefore(now, addMilliseconds(new Date(lastSpin), 1500))) {\n    throw new Error('pls wait 1.5s between hooers');\n}\nstore.set('lastspin$' + IRC.message.from, now.toISOString());\n\nconst fruit = [\n    '{y,o} Cinnamon ',\n    '{w,dr} Crystal ',\n    '{w,dp} Venus ',\n    '{w,dg} Bethany ',\n    '{w,dr} Brandy ',\n    '{dgr,gr} Mercedes ',\n    '{p,dc} Tequila ',\n    '{w,o} Sapphire ',\n    '{r,dg} Jasmine ',\n    '{y,bl} Roxanne ',\n    '{dg,bl} Tatiana ',\n    '{w,o} Amber ',\n    '{y,dr} Lola ',\n    '{y,bl} Angel ',\n    '{w,dp} Ginger ',\n    '{g,dr} Candy ',\n    '{w,gr} Charity ',\n    '{w,dc} Anastasia ',\n    '{y,dg} Kitty ',\n    '{y,db} Raven ',\n    '{rb} Spontaneous Bootay '\n].map(d => d + '{/}');\nconst bagSize = 15;\nconst wheelQty = 3;\nconst defaultJackpot = 777;\nconst cost = 7;\nconst c = '$';\n\nconst bag = _.shuffle(fruit).splice(0, bagSize);\nconst roll = () => {\n    return bag[(Math.random())*bagSize|0];\n};\n\nconst wheels = Array.from({length: wheelQty}).map(roll);\n\nlet jackpot = store.get('$jackpot');\nif (!jackpot) {\n    jackpot = defaultJackpot;\n    store.set('$jackpot', defaultJackpot)\n}\nconst jackpotStr = Intl.NumberFormat().format(+jackpot);\nconst pad = wheels.map(d => d.replace(/{(.*?)}/g,'').length).reduce((a, b) => a + b, 0) - 15 - jackpotStr.length;\nprint(`{o}[{y} SLOOTS{/} ${pad>0?' '.repeat(pad):''}{g}Jackpot{/} {y}${c}${jackpotStr}{/}{o}]{dgr} *ball gargling sounds*{/}`);\nprint('{o}(' + wheels.join('{y}-{/}') + '{o}){y}/{r}Â°');\n\nconst funds = store.get(IRC.message.from) || 777;\n\nif (_.uniq(wheels).length == 1) {\n    const newScore = +funds + +jackpot\n    store.set(IRC.message.from, newScore)\n    print(`{bl,gr}{rb} 8====D S L U T P O T 8====D {/} ${IRC.message.from} has {y}${c}${Intl.NumberFormat().format(newScore)}`);\n    store.set('$jackpot', defaultJackpot);\n}\nelse if (wheels[0]==wheels[1] || wheels[1] == wheels[2]) {\n    const win = ((Math.random()*35)|0)+1;\n    const newScore = +funds + win;\n    store.set(IRC.message.from, newScore);\n    print(`${IRC.message.from} won {y}${c}${win}{/}! and has {y}${c}${Intl.NumberFormat().format(newScore)}{/}`);\n}\nelse {\n    const newScore = +funds - cost\n    store.set(IRC.message.from, newScore);\n    print(`${IRC.message.from} has {y}${c}${Intl.NumberFormat().format(newScore)}{/}`)\n    store.set('$jackpot', +jackpot + (cost * 2));\n}",
    "locked": true,
    "starred": false
}
